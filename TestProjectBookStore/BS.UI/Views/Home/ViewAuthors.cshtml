@{
    ViewBag.Title = "Home Page";
}
@Html.Partial("_CreateAuthorPopup")

<div class="row">
    <div class="col-lg-1 col-md-1 col-sm-1 offset-lg-2 offset-md-2 offset-sm-2">
        <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#create-author-modal">
            Add Author
        </button>
    </div>
</div>
<div class="row justify-content-center">
    <div class="col-lg-10 col-md-10 col-sm-10">
        <table class="table">
            <thead id="tablehead">
                <tr>
                    <th scope="col">FirstName</th>
                    <th scope="col">LastName</th>
                    <th scope="col">BooksCount</th>
                    <th scope="col">Actions</th>
                </tr>
            </thead>
            <tbody id="tablebody" data-bind="foreach: authors">
                <tr data-bind="template: { name: Mode, data: $data }"></tr>
            </tbody>
        </table>
    </div>
</div>



<script type="text/html" id="display">
    <td data-bind="text: FirstName"></td>
    <td data-bind="text: LastName"></td>
    <td data-bind="text: BooksCount"></td>
    <td>
        <button class="btn btn-success kout-edit">Edit</button>
        <button class="btn btn-danger kout-delete" id="author-delete" data-url=@Url.Action("Delete", "Author")>Delete</button>
    </td>
</script>
<script type="text/html" id="edit">
    <td><input class="form-control" type="text" data-bind="value: FirstName" /></td>
    <td><input class="form-control" type="text" data-bind="value: LastName" /></td>
    <td data-bind="text: BooksCount"></td>
    <td>
        <button class="btn btn-success kout-update" id="author-edit" data-url=@Url.Action("Edit", "Author")>Update</button>
        <button class="btn btn-danger kout-cancel">Cancel</button>
    </td>
</script>
<script>
    $(document).ready(function () {
        AuthorManagement.Initialize();
    });
    $(document).on("click", ".kout-edit", null, function (ev) {
        var current = ko.dataFor(this);
        current.Mode("edit");
    })

    $(document).on("click", ".kout-update", null, function (ev) {
        var current = ko.dataFor(this);
        AuthorManagement.saveData(current);
        current.Mode("display");
    })

    $(document).on("click", ".kout-delete", null, function (ev) {
        var current = ko.dataFor(this);
        AuthorManagement.OnDeleteClick(current);
    })
</script>
